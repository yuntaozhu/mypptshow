<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrossFit Pascal's WOD</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --accent-low: #4ade80;   /* Green for low intensity */
            --accent-mid: #fbbf24;   /* Amber for mid intensity */
            --accent-high: #ef4444;  /* Red for high intensity */
            --card-bg: #262626;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 2.5rem;
            margin-bottom: 10px;
            border-bottom: 3px solid var(--accent-high);
            display: inline-block;
            padding-bottom: 5px;
        }

        p.subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            padding: 20px;
            overflow-x: auto; /* Allow scroll on small screens */
            text-align: center;
        }

        /* SVG Styling */
        svg {
            display: block;
            margin: 0 auto;
            font-family: 'Courier New', monospace;
        }

        .node-shape {
            stroke: #333;
            stroke-width: 2px;
            transition: transform 0.2s ease, filter 0.2s ease;
            cursor: pointer;
        }

        .node-group:hover .node-shape {
            transform: scale(1.1);
            filter: brightness(1.2);
            z-index: 10;
        }

        .node-text-name {
            font-weight: bold;
            font-size: 14px;
            fill: #fff;
            pointer-events: none;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .node-text-num {
            font-size: 10px;
            fill: rgba(255,255,255,0.7);
            pointer-events: none;
        }

        .legend {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

    </style>
</head>
<body>

    <header>
        <h1>Pascal's WOD</h1>
        <p class="subtitle">基于帕斯卡三角的 CrossFit 强度递增训练计划 <br> (7 Rounds for Quality or Time)</p>
    </header>

    <div class="container" id="visualization-container">
        <!-- SVG will be injected here by JS -->
    </div>

    <div class="legend">
        <div class="legend-item"><div class="dot" style="background: var(--accent-low)"></div>基础 (Cardio/Basic)</div>
        <div class="legend-item"><div class="dot" style="background: var(--accent-mid)"></div>进阶 (Skill/Power)</div>
        <div class="legend-item"><div class="dot" style="background: var(--accent-high)"></div>极限 (Heavy/Complex)</div>
    </div>

<script>
    // Configuration
    const ROWS = 7; 
    const SVG_WIDTH = 900;
    const SVG_HEIGHT = 600;
    const NODE_RADIUS = 35; // Size of the hexagons/circles
    const Y_SPACING = 75;
    
    // Mapping Logic
    const movementMap = {
        1: { name: "Burpee", type: "low" },
        2: { name: "Sit-up", type: "low" },
        3: { name: "Push-up", type: "low" },
        4: { name: "Air Squat", type: "low" },
        5: { name: "Box Jump", type: "mid" },
        6: { name: "KB Swing", type: "mid" },
        10: { name: "Wall Ball", type: "mid" },
        15: { name: "Toes-2-Bar", type: "high" },
        20: { name: "Thruster", type: "high" }
    };

    // Helper: Get Color based on intensity type
    function getColor(val) {
        // Default logic for unmapped numbers (fallback)
        let type = 'low';
        if (movementMap[val]) {
            type = movementMap[val].type;
        } else {
            if (val > 10) type = 'high';
            else if (val > 4) type = 'mid';
        }

        switch(type) {
            case 'low': return '#4ade80'; // Green
            case 'mid': return '#fbbf24'; // Amber
            case 'high': return '#ef4444'; // Red
            default: return '#a0a0a0';
        }
    }

    // Helper: Get Movement Name
    function getName(val) {
        return movementMap[val] ? movementMap[val].name : "Rest";
    }

    // 1. Generate Pascal's Triangle Data
    function generatePascalTriangle(n) {
        let triangle = [];
        for (let i = 0; i < n; i++) {
            triangle[i] = new Array(i + 1);
            triangle[i][0] = 1;
            triangle[i][i] = 1;
            for (let j = 1; j < i; j++) {
                triangle[i][j] = triangle[i-1][j-1] + triangle[i-1][j];
            }
        }
        return triangle;
    }

    // 2. Render Logic
    function renderTriangle() {
        const triangle = generatePascalTriangle(ROWS);
        const container = document.getElementById('visualization-container');
        
        // Create SVG element
        const svgNS = "http://www.w3.org/2000/svg";
        const svg = document.createElementNS(svgNS, "svg");
        svg.setAttribute("width", "100%");
        svg.setAttribute("height", SVG_HEIGHT);
        svg.setAttribute("viewBox", `0 0 ${SVG_WIDTH} ${SVG_HEIGHT}`);

        // Calculate centering
        const centerX = SVG_WIDTH / 2;
        const startY = 60;

        triangle.forEach((row, rowIndex) => {
            const rowWidth = row.length * (NODE_RADIUS * 2.2); // Width of the current row
            const startX = centerX - (rowWidth / 2) + NODE_RADIUS * 1.1;

            row.forEach((val, colIndex) => {
                const x = startX + colIndex * (NODE_RADIUS * 2.2);
                const y = startY + rowIndex * Y_SPACING;
                const color = getColor(val);
                const moveName = getName(val);

                // Create Group
                const g = document.createElementNS(svgNS, "g");
                g.setAttribute("class", "node-group");
                // Center transform origin for hover effect
                g.style.transformBox = "fill-box";
                g.style.transformOrigin = "center";

                // Draw Hexagon (Polygon) or Circle. Let's do a rounded rect/pill for better text fit
                const rect = document.createElementNS(svgNS, "rect");
                rect.setAttribute("x", x - 40);
                rect.setAttribute("y", y - 25);
                rect.setAttribute("width", 80);
                rect.setAttribute("height", 50);
                rect.setAttribute("rx", 10);
                rect.setAttribute("ry", 10);
                rect.setAttribute("fill", color);
                rect.setAttribute("class", "node-shape");
                
                // Movement Text
                const textName = document.createElementNS(svgNS, "text");
                textName.setAttribute("x", x);
                textName.setAttribute("y", y + 2); // slight adjustment
                textName.setAttribute("text-anchor", "middle");
                textName.setAttribute("class", "node-text-name");
                textName.textContent = moveName;

                // Number Text (Small)
                const textNum = document.createElementNS(svgNS, "text");
                textNum.setAttribute("x", x);
                textNum.setAttribute("y", y + 18);
                textNum.setAttribute("text-anchor", "middle");
                textNum.setAttribute("class", "node-text-num");
                textNum.textContent = `(Val: ${val})`;

                g.appendChild(rect);
                g.appendChild(textName);
                g.appendChild(textNum);
                svg.appendChild(g);
            });
        });

        container.appendChild(svg);
    }

    // Run
    renderTriangle();

</script>

</body>
</html>
